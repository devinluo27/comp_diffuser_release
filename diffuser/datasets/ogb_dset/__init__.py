from diffuser.datasets.ogb_dset.ogb_dataset_v1 import OgB_SeqDataset_V1
from diffuser.datasets.ogb_dset.ogb_dataset_v2 import OgB_SeqDataset_V2
from diffuser.datasets.ogb_dset.ogb_invdyn_dataset_v1 import OgB_InvDyn_SeqDataset_V1
from diffuser.datasets.ogb_dset.ogb_utils import ogb_load_env
import numpy as np

"""
Lines below stores constants for normalization, which is used when training and inference.
"""

## For OGBench Normalization Data, can save loading time when start planning
## but make sure this data is correct (same as for training)

## --------------- Ant Giant Stitch ----------------

OgB_AntMaze_Giant_Stitch_Obs_Min = \
    np.array([-1.7522262  , -1.6690609455   ,  0.20817915 , -0.68730515 ,
       -0.99955153 , -0.99938685 , -0.99982953 , -0.6646344  ,
       -0.099802665, -0.6642567  , -1.3391876  , -0.66544014 ,
       -1.3356669  , -0.66558236 , -0.09999122 , -3.7836382  ,
       -3.5003748  , -3.2529933  , -6.5485487  , -5.8124557  ,
       -5.9822607  , -7.395235   , -6.3903627  , -7.51118    ,
       -8.749544   , -7.5296645  , -8.745907   , -7.5600452  ,
       -6.2018595  ], dtype=np.float32)

OgB_AntMaze_Giant_Stitch_Obs_Max = \
    np.array([53.6969261169   , 37.6083793640    ,  1.1590688  ,  0.9999965  ,
        0.99935406 ,  0.99771285 ,  0.8982374  ,  0.6657312  ,
        1.3388288  ,  0.66486377 ,  0.099887945,  0.6691368  ,
        0.09993197 ,  0.6682219  ,  1.3348885  ,  3.609179   ,
        3.5336463  ,  3.1469495  ,  9.413382   ,  5.9201727  ,
        6.7396574  ,  7.5086093  ,  8.485675   ,  7.5146103  ,
        6.358327   ,  7.560185   ,  6.4324718  ,  7.3989816  ,
        8.605962   ], dtype=np.float32)

OgB_AntMaze_Giant_Act_Min = \
    np.array([-1., -1., -1., -1., -1., -1., -1., -1.], dtype=np.float32)


OgB_AntMaze_Giant_Act_Max = \
    np.array([1., 1., 1., 1., 1., 1., 1., 1.], dtype=np.float32)


OgB_AntMaze_Giant_Stitch_Obs__Min_Max = \
    np.array([OgB_AntMaze_Giant_Stitch_Obs_Min, 
              OgB_AntMaze_Giant_Stitch_Obs_Max], dtype=np.float32)

OgB_AntMaze_Giant_Act__Min_Max = \
    np.array([
        OgB_AntMaze_Giant_Act_Min,
        OgB_AntMaze_Giant_Act_Max,], dtype=np.float32)

## ------------------------------------------------

## ------------ Ant Maze Large Stitch -------------
# np.array(, dtype=np.float32)

OgB_AntMaze_Large_Stitch_Obs_Min = \
    np.array(
        [-1.6319645643, -1.5916854143,  0.2026090622, -0.6938870549,
        -0.9997432828, -0.9996500611, -0.9998207092, -0.6637751460,
        -0.0999357700, -0.6630499363, -1.3398716450, -0.6664142013,
        -1.3347414732, -0.6644892693, -0.0999758095, -4.1511039734,
        -3.3794775009, -3.3423562050, -8.5136289597, -6.8470268250,
        -6.0963425636, -7.5740590096, -6.4105319977, -7.5057597160,
        -8.6939926147, -7.5444693565, -8.7773437500, -7.5492405891,
        -6.2634658813], dtype=np.float32)

OgB_AntMaze_Large_Stitch_Obs_Max = \
    np.array(
        [37.5917167664, 25.7077789307,  1.1709419489,  0.9999970198,
         0.9994812012,  0.9980817437,  0.9326383471,  0.6648176312,
         1.3405964375,  0.6678727865,  0.0999789461,  0.6663091779,
         0.0999992937,  0.6659904718,  1.3412072659,  3.8047070503,
         3.8870372772,  3.0222635269,  6.3553433418,  5.8696293831,
         6.4969573021,  7.4621505737,  8.7481498718,  7.4953885078,
         6.3743925095,  7.5601973534,  6.3459782600,  7.4379615784,
         8.5396280289], dtype=np.float32)


OgB_AntMaze_Large_Stitch_Obs__Min_Max = \
    np.array([
        OgB_AntMaze_Large_Stitch_Obs_Min,
        OgB_AntMaze_Large_Stitch_Obs_Max,], dtype=np.float32)




## -------------------------------------------------
## ------------ Ant Maze Medium Stitch -------------


OgB_AntMaze_Medium_Stitch_Obs_Min = \
    np.array(
        [-1.7398624420, -1.4323651791,  0.2001425326, -0.6922681332,
        -0.9988154769, -0.9999274015, -0.9997754693, -0.6648562551,
        -0.0999554396, -0.6648074389, -1.3391921520, -0.6644653678,
        -1.3357307911, -0.6643492579, -0.0999565497, -3.6985247135,
        -3.3733789921, -3.3698370457, -6.8785858154, -6.7049665451,
        -6.2694149017, -7.4637980461, -6.2251229286, -7.5196199417,
        -8.6110763550, -7.4761219025, -8.7294893265, -7.5395035744,
        -6.1587929726], dtype=np.float32)


OgB_AntMaze_Medium_Stitch_Obs_Max = \
    np.array(
        [21.4323711395, 21.2391986847,  1.1264404058,  0.9999970794,
         0.9997657537,  0.9987641573,  0.9742431045,  0.6666992903,
         1.3446338177,  0.6656451821,  0.0998993590,  0.6664491296,
         0.0997980461,  0.6675296426,  1.3322278261,  3.6701469421,
         3.5237774849,  2.9652285576,  6.7863092422,  6.1057281494,
         7.1496992111,  7.5703396797,  8.4705190659,  7.5033030510,
         6.3354969025,  7.6090364456,  6.3890829086,  7.4926004410,
         8.6442508698], dtype=np.float32)


OgB_AntMaze_Medium_Stitch_Obs__Min_Max = \
    np.array([
        OgB_AntMaze_Medium_Stitch_Obs_Min,
        OgB_AntMaze_Medium_Stitch_Obs_Max,], dtype=np.float32)




## --------------------------------------------------
## ------------ Ant Maze Medium Explore -------------
## --------------------------------------------------


OgB_AntMaze_Medium_Explore_Obs_Min = \
    np.array([-1.7501143  , -1.743888   ,  0.20805515 , -0.7736227  ,
       -0.99997276 , -0.99987614 , -0.9999829  , -0.6692852  ,
       -0.09995851 , -0.6692012  , -1.352111   , -0.6678871  ,
       -1.3536744  , -0.66738605 , -0.099978045, -3.7337127  ,
       -3.312653   , -3.955324   , -9.374349   , -6.7790966  ,
       -5.776723   , -7.5521536  , -6.407716   , -7.620753   ,
       -8.842789   , -7.579709   , -8.712652   , -7.5904574  ,
       -6.4330287  ], dtype=np.float32)

OgB_AntMaze_Medium_Explore_Obs_Max = \
    np.array([21.757572  , 21.697845  ,  1.3064691 ,  0.99999946,  0.99984246,
        0.9999304 ,  0.9969152 ,  0.6668245 ,  1.3492123 ,  0.6689429 ,
        0.09999718,  0.66772807,  0.09996808,  0.66795063,  1.3525184 ,
        3.5111833 ,  3.6119962 ,  3.5837972 ,  7.3375206 ,  7.0673256 ,
        6.047417  ,  7.5556855 ,  8.7549925 ,  7.5883985 ,  6.4211264 ,
        7.5730343 ,  6.4360642 ,  7.572352  ,  8.748335  ], dtype=np.float32)

OgB_AntMaze_Medium_Explore_Obs__Min_Max = \
    np.array([OgB_AntMaze_Medium_Explore_Obs_Min, 
              OgB_AntMaze_Medium_Explore_Obs_Max], dtype=np.float32)




## -------------------------------------------------
## ------------ Ant Maze Large Explore -------------



OgB_AntMaze_Large_Explore_Obs_Min = \
    np.array([-1.7511344  , -1.7456294  ,  0.19864318 , -0.86265326 ,
       -0.99982655 , -0.99989015 , -0.9999986  , -0.6678376  ,
       -0.09998043 , -0.6696295  , -1.3599646  , -0.6700877  ,
       -1.3621099  , -0.6674724  , -0.099971734, -3.1847715  ,
       -3.8194654  , -3.8607056  , -8.191345   , -7.1607366  ,
       -5.563917   , -7.5964456  , -6.4257636  , -7.5630016  ,
       -8.729115   , -7.5928974  , -8.866859   , -7.586669   ,
       -6.4038544  ], dtype=np.float32)
   

OgB_AntMaze_Large_Explore_Obs_Max = \
    np.array([37.529156  , 25.74817   ,  1.2845832 ,  0.99999934,  0.9999943 ,
        0.9999883 ,  0.9779557 ,  0.6674764 ,  1.3542227 ,  0.66780436,
        0.09998613,  0.66714424,  0.09997814,  0.66929007,  1.3543218 ,
        3.701073  ,  3.147653  ,  3.0343513 ,  7.2361627 ,  6.639552  ,
        5.697303  ,  7.5480733 ,  8.797978  ,  7.5569096 ,  6.3935957 ,
        7.558352  ,  6.4829025 ,  7.600823  ,  8.864995  ], dtype=np.float32)

OgB_AntMaze_Large_Explore_Obs__Min_Max = \
    np.array([OgB_AntMaze_Large_Explore_Obs_Min, 
              OgB_AntMaze_Large_Explore_Obs_Max], dtype=np.float32)






## --------------- Humanoid Giant Stitch ----------------
from diffuser.datasets.ogb_dset.init_hum_const import *


## ------------------ Ant Soccer --------------------

# np.array(
        # , dtype=np.float32)

OgB_AntSoccer_Arena_Stitch_Obs_Min = \
    np.array(
        [-1.6488044262, -1.5109552145,  0.2195503414, -0.6930528283,
        -0.9990211725, -0.9982697964, -0.9998267889, -0.6654517651,
        -0.0998514965, -0.6671048403, -1.3376626968, -0.6643897295,
        -1.3467545509, -0.6638010144, -0.0999953896, -1.7524244785,
        -1.7484039068,  0.1928527951, -0.9997825027, -0.9989981651,
        -0.9993247390, -0.9999110699, -3.6669499874, -3.4235854149,
        -3.1671118736, -6.4294514656, -7.1678042412, -5.0263319016,
        -7.4378123283, -6.3124322891, -7.5177168846, -8.7859840393,
        -7.4390044212, -8.7458133698, -7.5170307159, -6.2763671875,
        -6.9054789543, -6.1550440788, -4.0150289536, -6.0503783226,
        -7.2464361191, -6.7829079628], dtype=np.float32)



OgB_AntSoccer_Arena_Stitch_Obs_Max = \
    np.array(
        [21.4937076569, 21.5385990143,  1.1294838190,  0.9999998808,
         0.9995429516,  0.9977957606,  0.9999768138,  0.6634110808,
         1.3386257887,  0.6649051905,  0.0999973640,  0.6704475880,
         0.0999293625,  0.6660392880,  1.3401188850, 21.7641601562,
         21.7536067963,  1.1859340668,  0.9999940991,  0.9945118427,
         0.9980816841,  0.9997421503,  3.7378118038,  3.4180307388,
         3.0102732182,  7.3322892189,  7.0799794197,  5.2409515381,
         7.5265421867,  8.6178703308,  7.5648655891,  6.3814315796,
         7.5397219658,  6.3850779533,  7.5059652328,  8.6200237274,
         6.6854605675,  5.0899600983,  3.3470661640,  6.4374861717,
         6.6382007599,  6.7502326965], dtype=np.float32)


OgB_AntSoccer_Arena_Stitch_Obs__Min_Max = \
    np.array([
        OgB_AntSoccer_Arena_Stitch_Obs_Min,
        OgB_AntSoccer_Arena_Stitch_Obs_Max,], dtype=np.float32)


## ----------------------------

OgB_AntSoccer_Medium_Stitch_Obs_Min = \
    np.array(
        [-1.7426174879, -1.7084784508,  0.2045174241, -0.8367972374,
        -0.9997348189, -0.9995422363, -0.9999732971, -0.6666382551,
        -0.0999717638, -0.6665539145, -1.3402293921, -0.6687941551,
        -1.3393079042, -0.6667850018, -0.0999941528, -1.7684469223,
        -1.7619992495,  0.1900893450, -0.9997675419, -0.9993983507,
        -0.9987720847, -0.9999446273, -3.7312977314, -4.1684579849,
        -3.6590747833, -6.5157365799, -6.1697082520, -6.2582058907,
        -7.5357732773, -6.2583789825, -7.5298666954, -8.7102060318,
        -7.4562869072, -8.7476739883, -7.5198535919, -6.3180179596,
        -6.6376605034, -5.7407736778, -3.8924458027, -6.3174395561,
        -6.8695755005, -6.6082711220], dtype=np.float32)



OgB_AntSoccer_Medium_Stitch_Obs_Max = \
    np.array(
        [21.4952182770, 21.7334709167,  1.4034608603,  1.0000000000,
         0.9997558594,  0.9989274740,  1.0000000000,  0.6639200449,
         1.3421735764,  0.6672018766,  0.0999910831,  0.6669315100,
         0.0999817178,  0.6650683284,  1.3406193256, 21.7675895691,
         21.7589893341,  1.2636759281,  0.9999971986,  0.9994161725,
         0.9996258020,  0.9998835921,  3.8247377872,  3.5169281960,
         3.2892627716,  7.3772687912,  7.1374444962,  6.7092423439,
         7.5132350922,  8.7809352875,  7.5190372467,  6.3814153671,
         7.5437679291,  6.3518505096,  7.5103325844,  8.6367921829,
         6.1637401581,  5.6911182404,  3.9133856297,  6.6458768845,
         6.6638402939,  7.3901939392], dtype=np.float32)


# np.array(
        # , dtype=np.float32)


OgB_AntSoccer_Medium_Stitch_Obs__Min_Max = \
    np.array([
        OgB_AntSoccer_Medium_Stitch_Obs_Min,
        OgB_AntSoccer_Medium_Stitch_Obs_Max,], dtype=np.float32)


## ----------------------------------------------
## ----------------- Point Maze -----------------
## ----------------------------------------------





OgB_PointMaze_Giant_Stitch_Obs_Min = \
    np.array(
        [-1.2609360218, -1.1820275784], dtype=np.float32)


OgB_PointMaze_Giant_Stitch_Obs_Max = \
    np.array(
        [53.2429580688, 37.2854003906], dtype=np.float32)


OgB_PointMaze_Giant_Stitch_Obs__Min_Max = \
    np.array([
        OgB_PointMaze_Giant_Stitch_Obs_Min,
        OgB_PointMaze_Giant_Stitch_Obs_Max,], dtype=np.float32)




OgB_PointMaze_Giant_Act_Min = \
    np.array([-1., -1.,], dtype=np.float32)

OgB_PointMaze_Giant_Act_Max = \
    np.array([1., 1.,], dtype=np.float32)

OgB_PointMaze_Giant_Act__Min_Max = \
    np.array([
        OgB_PointMaze_Giant_Act_Min,
        OgB_PointMaze_Giant_Act_Max,], dtype=np.float32)


## ---------------- Large --------------------

OgB_PointMaze_Large_Stitch_Obs_Min = \
    np.array(
        [-1.2599442005, -1.2399553061], dtype=np.float32)


OgB_PointMaze_Large_Stitch_Obs_Max = \
    np.array(
        [37.3010253906, 25.3032455444], dtype=np.float32)

OgB_PointMaze_Large_Stitch_Obs__Min_Max = \
    np.array([
        OgB_PointMaze_Large_Stitch_Obs_Min,
        OgB_PointMaze_Large_Stitch_Obs_Max,], dtype=np.float32)



## ---------------- Medium --------------------



OgB_PointMaze_Medium_Stitch_Obs_Min = \
    np.array(
        [-1.2889566422, -1.1615521908], dtype=np.float32)


OgB_PointMaze_Medium_Stitch_Obs_Max = \
    np.array(
        [21.2544269562, 21.2463016510], dtype=np.float32)


OgB_PointMaze_Medium_Stitch_Obs__Min_Max = \
    np.array([
        OgB_PointMaze_Medium_Stitch_Obs_Min,
        OgB_PointMaze_Medium_Stitch_Obs_Max,], dtype=np.float32)




## -------------------------------------------------------
## ----------------- Ant Maze Navigate -----------------
## -------------------------------------------------------


OgB_AntMaze_Giant_Navigate_Obs_Min = \
    np.array(
        [-1.7409343719, -1.7416306734,  0.2002592832, -0.7262728214,
        -0.9998793602, -0.9996579885, -0.9999639988, -0.6655762196,
        -0.0986780822, -0.6640658379, -1.3422607183, -0.6668594480,
        -1.3355224133, -0.6647918224, -0.0993957669, -3.7930121422,
        -3.5975289345, -3.3653171062, -8.4990873337, -6.5584573746,
        -6.3419380188, -7.4988436699, -6.2769780159, -7.5564198494,
        -8.4139528275, -7.5117077827, -8.4329891205, -7.5495867729,
        -6.2091693878], dtype=np.float32)



OgB_AntMaze_Giant_Navigate_Obs_Max = \
    np.array(
        [53.4630699158, 37.5661048889,  1.2548201084,  0.9999905229,
         0.9999157786,  0.9992890954,  0.9131101370,  0.6661755443,
         1.3367191553,  0.6641290784,  0.0998725817,  0.6678156853,
         0.0998493955,  0.6666603684,  1.3387659788,  3.6507079601,
         3.7697050571,  2.9233636856,  7.0550665855,  5.7910504341,
         6.5748391151,  7.4644970894,  8.4332294464,  7.5282073021,
         6.3399372101,  7.6034193039,  6.2897229195,  7.4726862907,
         8.4318180084], dtype=np.float32)

OgB_AntMaze_Giant_Navigate_Obs__Min_Max = \
    np.array([OgB_AntMaze_Giant_Navigate_Obs_Min, 
              OgB_AntMaze_Giant_Navigate_Obs_Max], dtype=np.float32)
